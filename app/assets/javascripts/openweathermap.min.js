/*!
 * OpenWeatherMap
 * Copyright © 2012-2016 OpenWeatherMap, Inc.
 * Simplifed and compressed version of weather-widget-generator.js
 */
!function e(t,r,n){function a(o,s){if(!r[o]){if(!t[o]){var l="function"==typeof require&&require;if(!s&&l)return l(o,!0);if(i)return i(o,!0);var u=Error("Cannot find module '"+o+"'");throw u.code="MODULE_NOT_FOUND",u}var d=r[o]={exports:{}};t[o][0].call(d.exports,function(e){var r=t[o][1][e];return a(r?r:e)},d,d.exports,e,t,r,n)}return r[o].exports}for(var i="function"==typeof require&&require,o=0;o<n.length;o++)a(n[o]);return a}({1:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=function(e){function t(){return n(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),o(t,[{key:"numberDaysOfYearXXX",value:function(e){return e>365?!1:10>e?"00"+e:100>e?"0"+e:e}},{key:"convertDateToNumberDay",value:function(e){var t=new Date(e),r=new Date(t.getFullYear(),0,0),n=t-r,a=864e5,i=Math.floor(n/a);return t.getFullYear()+"-"+this.numberDaysOfYearXXX(i)}},{key:"convertNumberDayToDate",value:function(e){var t=/(\d{4})(-)(\d{3})/,r=t.exec(e),n=new Date(r[1]),a=n.getTime()+1e3*r[3]*60*60*24,i=new Date(a),o=i.getMonth()+1,s=i.getDate(),l=i.getFullYear();return(10>s?"0"+s:s)+"."+(10>o?"0"+o:o)+"."+l}},{key:"formatDate",value:function(e){var t=new Date(e),r=t.getFullYear(),n=t.getMonth()+1,a=t.getDate();return r+"-"+(10>n?"0"+n:n)+" - "+(10>a?"0"+a:a)}},{key:"getCurrentDate",value:function(){var e=new Date;return this.formatDate(e)}},{key:"getDateLastThreeMonth",value:function(){var e=new Date,t=(new Date).getFullYear(),r=new Date(e.getFullYear(),0,0),n=e-r,a=864e5,i=Math.floor(n/a);return i-=90,0>i&&(t-=1,i=365-i),t+"-"+this.numberDaysOfYearXXX(i)}},{key:"getCurrentSummerDate",value:function(){var e=(new Date).getFullYear(),t=this.convertDateToNumberDay(e+"-06-01"),r=this.convertDateToNumberDay(e+"-08-31");return[t,r]}},{key:"getCurrentSpringDate",value:function(){var e=(new Date).getFullYear(),t=this.convertDateToNumberDay(e+"-03-01"),r=this.convertDateToNumberDay(e+"-05-31");return[t,r]}},{key:"getLastSummerDate",value:function(){var e=(new Date).getFullYear()-1,t=this.convertDateToNumberDay(e+"-06-01"),r=this.convertDateToNumberDay(e+"-08-31");return[t,r]}},{key:"getFirstDateCurYear",value:function(){return(new Date).getFullYear()+" - 001"}},{key:"timestampToDateTime",value:function(e){var t=new Date(1e3*e);return t.toLocaleString().replace(/,/,"").replace(/:\w+$/,"")}},{key:"timestampToTime",value:function(e){var t=new Date(1e3*e),r=t.getHours(),n=t.getMinutes();return(10>r?"0"+r:r)+" : "+(10>n?"0"+n:n)+" "}},{key:"getNumberDayInWeekByUnixTime",value:function(e){var t=new Date(1e3*e);return t.getDay()}},{key:"getDayNameOfWeekByDayNumber",value:function(e,t){var t=myWidgetParam.lang?myWidgetParam.lang:"en",r={en:{0:"Sun",1:"Mon",2:"Tue",3:"Wed",4:"Thu",5:"Fri",6:"Sat"},fr:{0:"Dim",1:"Lun",2:"Mar",3:"Mer",4:"Jeu",5:"Ven",6:"Sam"}};return r[t][e]}},{key:"getMonthNameByMonthNumber",value:function(e){if("number"!=typeof e||0>=e&&e>=12)return null;var t={0:"Jan",1:"Feb",2:"Mar",3:"Apr",4:"May",5:"Jun",6:"Jul",7:"Aug",8:"Sep",9:"Oct",10:"Nov",11:"Dec"};return t[e]}},{key:"compareDatesWithToday",value:function(e){return e.toLocaleDateString()===(new Date).toLocaleDateString()}},{key:"convertStringDateMMDDYYYHHToDate",value:function(e){var t=/(\d{2})(\.{1})(\d{2})(\.{1})(\d{4})/,r=t.exec(e);return 6===r.length?new Date(r[5]+"-"+r[3]+"-"+r[1]):new Date}},{key:"getTimeDateHHMMMonthDay",value:function(){var e=new Date;return(e.getHours()<10?"0"+e.getHours():e.getHours())+":"+(e.getMinutes()<10?"0"+e.getMinutes():e.getMinutes())+" "+this.getMonthNameByMonthNumber(e.getMonth())+" "+e.getDate()}}]),t}(Date);r["default"]=s},{}],2:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});r.naturalPhenomenon={en:{name:"English",main:"",description:{200:"thunderstorm with light rain",201:"thunderstorm with rain",202:"thunderstorm with heavy rain",210:"light thunderstorm",211:"thunderstorm",212:"heavy thunderstorm",221:"ragged thunderstorm",230:"thunderstorm with light drizzle",231:"thunderstorm with drizzle",232:"thunderstorm with heavy drizzle",300:"light intensity drizzle",301:"drizzle",302:"heavy intensity drizzle",310:"light intensity drizzle rain",311:"drizzle rain",312:"heavy intensity drizzle rain",313:"shower rain and drizzle",314:"heavy shower rain and drizzle",321:"shower drizzle",500:"light rain",501:"moderate rain",502:"heavy intensity rain",503:"very heavy rain",504:"extreme rain",511:"freezing rain",520:"light intensity shower rain",521:"shower rain",522:"heavy intensity shower rain",531:"ragged shower rain",600:"light snow",601:"snow",602:"heavy snow",611:"sleet",612:"shower sleet",615:"light rain and snow",616:"rain and snow",620:"light shower snow",621:"shower snow",622:"heavy shower snow",701:"mist",711:"smoke",721:"haze",731:"sand,dust whirls",741:"fog",751:"sand",761:"dust",762:"volcanic ash",771:"squalls",781:"tornado",800:"clear sky",801:"few clouds",802:"scattered clouds",803:"broken clouds",804:"overcast clouds",900:"tornado",901:"tropical storm",902:"hurricane",903:"cold",904:"hot",905:"windy",906:"hail",950:"setting",951:"calm",952:"light breeze",953:"gentle breeze",954:"moderate breeze",955:"fresh breeze",956:"strong breeze",957:"high wind, near gale",958:"gale",959:"severe gale",960:"storm",961:"violent storm",962:"hurricane"}},fr:{name:"French",main:"",description:{200:"orage et pluie fine",201:"orage et pluie",202:"orage et fortes pluies",210:"orages légers",211:"orages",212:"gros orages",221:"orages éparses",230:"Orage avec légère bruine",231:"orages éparses",232:"gros orage",300:"Bruine légère",301:"Bruine",302:"Fortes bruines",310:"Pluie fine éparse",311:"pluie fine",312:"Crachin intense",321:"Averses de bruine",500:"légères pluies",501:"pluies modérées",502:"Fortes pluies",503:"très fortes précipitations",504:"grosses pluies",511:"pluie verglaçante",520:"petites averses",521:"averses de pluie",522:"averses intenses",600:"légères neiges",601:"neige",602:"fortes chutes de neige",611:"neige fondue",621:"averses de neige",701:"brume",711:"Brouillard",721:"brume",731:"tempêtes de sable",741:"brouillard",800:"ensoleillé",801:"peu nuageux",802:"partiellement ensoleillé",803:"nuageux",804:"Couvert",900:"tornade",901:"tempête tropicale",902:"ouragan",903:"froid",904:"chaud",905:"venteux",906:"grêle",950:"Très calme",951:"Calme",952:"Brise légère",953:"Brise douce",954:"Brise modérée",955:"Brise fraiche",956:"Brise forte",957:"Vent fort, presque violent",958:"Vent violent",959:"Vent très violent",960:"Tempête",961:"Tempête violente",962:"Ouragan"}}}},{}],3:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});r.windSpeed={en:{Settings:{speed_interval:[0,.3]},Calm:{speed_interval:[.3,1.6]},"Light breeze":{speed_interval:[1.6,3.3]},"Gentle Breeze":{speed_interval:[3.4,5.5]},"Moderate breeze":{speed_interval:[5.5,8]},"Fresh Breeze":{speed_interval:[8,10.8]},"Strong breeze":{speed_interval:[10.8,13.9]},"High wind, near gale":{speed_interval:[13.9,17.2]},Gale:{speed_interval:[17.2,20.7]},"Severe Gale":{speed_interval:[20.8,24.5]},Storm:{speed_interval:[24.5,28.5]},"Violent Storm":{speed_interval:[28.5,32.7]},Hurricane:{speed_interval:[32.7,64]}},fr:{"Très calme":{speed_interval:[0,.3]},Calme:{speed_interval:[.3,1.6]},"Brise légère":{speed_interval:[1.6,3.3]},"Brise douce":{speed_interval:[3.4,5.5]},"Brise modérée":{speed_interval:[5.5,8]},"Brise fraiche":{speed_interval:[8,10.8]},"Brise forte":{speed_interval:[10.8,13.9]},"Vent fort, presque violent":{speed_interval:[13.9,17.2]},"Vent violent":{speed_interval:[17.2,20.7]},"Vent très violent":{speed_interval:[20.8,24.5]},"Tempête":{speed_interval:[24.5,28.5]},"Tempête violente":{speed_interval:[28.5,32.7]},Ouragan:{speed_interval:[32.7,64]}}}},{}],4:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=function(){function e(){n(this,e),this.baseURL="http://openweathermap.org/themes/openweathermap/assets/vendor/owm",this.domElements={id21:{id:21,type:"left",schema:"white",dom:'<div class="widget-left"> <div class="widget-left-menu"> <div class="widget-left-menu__layout"> <h1 class="widget-left-menu__header"></h1> <div class="widget-left-menu__links"><a href="//openweathermap.org/" target="_blank" class="widget-left-menu__link">OpenWeatherMap</a></div> </div></div><div class="widget-left__body"> <div class="weather-left-card weather-left-card--grayscale"> <div class="weather-left-card__row1"> <img src="" width="128" height="128" alt="" class="weather-left-card__img"/> <div class="weather-left-card__col"> <p class="weather-left-card__number">0<span class="weather-left-card__degree">&176;</span></p> </div></div><div class="weather-left-card__row2"> <p class="weather-left-card__means">-</p><p class="weather-left-card__wind">Wind:</p></div></div><div class="widget-left__calendar"> <ul class="calendar calendar--grayscale"> <li class="calendar__item"><img src="" width="32" height="32" alt=""/></li><li class="calendar__item"><img src="" width="32" height="32" alt=""/></li><li class="calendar__item"><img src="" width="32" height="32" alt=""/></li><li class="calendar__item"><img src="" width="32" height="32" alt=""/></li><li class="calendar__item"><img src="" width="32" height="32" alt=""/></li><li class="calendar__item"><img src="" width="32" height="32" alt=""/></li><li class="calendar__item"><img src="" width="32" height="32" alt=""/></li><li class="calendar__item"><img src="" width="32" height="32" alt=""/></li></ul> <div id="graphic" class="widget-left__graphic"></div></div></div></div>'}}}return a(e,[{key:"render",value:function(){if(window.myWidgetParam){this.selDOMElement=this.domElements["id"+window.myWidgetParam.id];var e=document.getElementById(window.myWidgetParam.containerid);e.insertAdjacentHTML("afterbegin",this.selDOMElement.dom)}}}]),e}();r["default"]=i},{}],5:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=e("./custom-date"),u=n(l),d=function(e){function t(e){a(this,t);var r=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return r.params=e,r.temperaturePolygon=d3.line().x(function(e){return e.x}).y(function(e){return e.y}),r}return o(t,e),s(t,[{key:"prepareData",value:function(){var e=0,t=[];return this.params.data.forEach(function(r){t.push({x:e,date:e,maxT:r.max,minT:r.min}),e+=1}),t}},{key:"makeSVG",value:function(){return d3.select(this.params.id).append("svg").attr("class","axis").attr("width",this.params.width).attr("height",this.params.height).attr("fill",this.params.colorPolilyne).style("stroke","#ffffff")}},{key:"getMinMaxDate",value:function(e){var t={maxDate:0,minDate:1e4};return e.forEach(function(e){t.maxDate<=e.date&&(t.maxDate=e.date),t.minDate>=e.date&&(t.minDate=e.date)}),t}},{key:"getMinMaxTemperature",value:function(e){var t={min:100,max:0};return e.forEach(function(e){t.min>=e.minT&&(t.min=e.minT),t.max<=e.maxT&&(t.max=e.maxT)}),t}},{key:"getMinMaxWeather",value:function(e){var t={min:0,max:0};return e.forEach(function(e){t.min>=e.humidity&&(t.min=e.humidity),t.min>=e.rainfallAmount&&(t.min=e.rainfallAmount),t.max<=e.humidity&&(t.max=e.humidity),t.max<=e.rainfallAmount&&(t.max=e.rainfallAmount)}),t}},{key:"makeAxesXY",value:function(e,t){var r=t.width-2*t.margin,n=t.height-2*t.margin;return this.scaleAxesXYTemperature(e,r,n,t)}},{key:"scaleAxesXYTemperature",value:function(e,t,r,n){var a=this.getMinMaxDate(e),i=a.maxDate,o=a.minDate,s=this.getMinMaxTemperature(e),l=s.min,u=s.max,d=d3.scaleTime().domain([new Date(o),new Date(i)]).range([0,t]),c=d3.scaleLinear().domain([u+5,l-5]).range([0,r]),m=[];return e.forEach(function(e){m.push({x:d(e.date)+n.offsetX,maxT:c(e.maxT)+n.offsetX,minT:c(e.minT)+n.offsetX})}),{scaleX:d,scaleY:c,data:m}}},{key:"scaleAxesXYWeather",value:function(e,t,r,n){var a=this.getMinMaxDate(e),i=a.maxDate,o=a.minDate,s=this.getMinMaxWeather(e),l=s.min,u=s.max,d=d3.scaleTime().domain([new Date(o),new Date(i)]).range([0,t]),c=d3.scaleLinear().domain([u,l]).range([0,r]),m=[];return e.forEach(function(e){m.push({x:d(e.date)+n,humidity:c(e.humidity)+n,rainfallAmount:c(e.rainfallAmount)+n,color:e.color})}),{scaleX:d,scaleY:c,data:m}}},{key:"makePolyline",value:function(e,t,r,n){var a=[];return e.forEach(function(e){a.push({x:r(e.date)+t.offsetX,y:n(e.maxT)+t.offsetY})}),e.reverse().forEach(function(e){a.push({x:r(e.date)+t.offsetX,y:n(e.minT)+t.offsetY})}),a.push({x:r(e[e.length-1].date)+t.offsetX,y:n(e[e.length-1].maxT)+t.offsetY}),a}},{key:"drawPolyline",value:function(e,t){e.append("g").append("path").style("stroke-width",this.params.strokeWidth).attr("d",this.temperaturePolygon(t)).style("stroke",this.params.colorPolilyne).style("fill",this.params.colorPolilyne).style("opacity",1)}},{key:"drawLabelsTemperature",value:function(e,t,r){t.forEach(function(t,n,a){e.append("text").attr("x",t.x).attr("y",t.maxT-2-r.offsetX/2).attr("text-anchor","middle").style("font-size",r.fontSize).style("stroke",r.fontColor).style("fill",r.fontColor).text(r.data[n].max+"°"),e.append("text").attr("x",t.x).attr("y",t.minT+7+r.offsetY/2).attr("text-anchor","middle").style("font-size",r.fontSize).style("stroke",r.fontColor).style("fill",r.fontColor).text(r.data[n].min+"°")})}},{key:"render",value:function(){var e=this.makeSVG(),t=this.prepareData(),r=this.makeAxesXY(t,this.params),n=r.scaleX,a=r.scaleY,i=r.data,o=this.makePolyline(t,this.params,n,a);this.drawPolyline(e,o),this.drawLabelsTemperature(e,i,this.params)}}]),t}(u["default"]);r["default"]=d},{"./custom-date":1}],6:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var a=e("./weather-widget"),i=n(a),o=e("./generator-widget"),s=n(o),l=new s["default"];if(l.render(),window.myWidgetParam){var u="";u=window.myWidgetParam.cityid?"?id="+window.myWidgetParam.cityid:window.myWidgetParam.city_name?"?q="+window.myWidgetParam.city_name:"?q=London";var d="#000";l.selDOMElement.colorPolilyne&&(d=l.selDOMElement.colorPolilyne);var c={cityName:"Montreal",lang:window.myWidgetParam.lang?window.myWidgetParam.lang:"en",appid:window.myWidgetParam.appid,units:"metric",textUnitTemp:String.fromCodePoint(176),colorPolilyne:d,baseURL:l.baseURL,urlDomain:"http://api.openweathermap.org"},m={cityName:document.querySelectorAll(".widget-left-menu__header"),temperature:document.querySelectorAll(".weather-left-card__number"),naturalPhenomenon:document.querySelectorAll(".weather-left-card__means"),windSpeed:document.querySelectorAll(".weather-left-card__wind"),mainIconWeather:document.querySelectorAll(".weather-left-card__img"),calendarItem:document.querySelectorAll(".calendar__item"),graphic:document.getElementById("graphic"),cityName2:document.querySelectorAll(".widget-right__title"),temperature2:document.querySelectorAll(".weather-right__temperature"),temperatureFeels:document.querySelectorAll(".weather-right__feels"),temperatureMin:document.querySelectorAll(".weather-right-card__temperature-min"),temperatureMax:document.querySelectorAll(".weather-right-card__temperature-max"),naturalPhenomenon2:document.querySelectorAll(".widget-right__description"),windSpeed2:document.querySelectorAll(".weather-right__wind-speed"),mainIconWeather2:document.querySelectorAll(".weather-right__icon"),humidity:document.querySelectorAll(".weather-right__humidity"),pressure:document.querySelectorAll(".weather-right__pressure"),dateReport:document.querySelectorAll(".widget-right__date")},h={urlWeatherAPI:c.urlDomain+"/data/2.5/weather"+u+"&units="+c.units+"&appid="+c.appid+"&lang="+c.lang,paramsUrlForeDaily:c.urlDomain+"/data/2.5/forecast/daily"+u+"&units="+c.units+"&cnt=8&appid="+c.appid,windSpeed:c.baseURL+"/data/wind-speed-data.json",windDirection:c.baseURL+"/data/wind-direction-data.json",clouds:c.baseURL+"data/clouds-data.json",naturalPhenomenon:c.baseURL+"/data/natural-phenomenon-data.json"},p=new i["default"](c,m,h);(m.cityName.length||m.cityName2.length)&&p.render()}},{"./generator-widget":4,"./weather-widget":7}],7:[function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}function a(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(r,"__esModule",{value:!0});var l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),d=e("./custom-date"),c=a(d),m=e("./graphic-d3js"),h=a(m),p=e("./data/natural-phenomenon-data"),f=n(p),y=e("./data/wind-speed-data"),w=n(y),g=(n(y),function(e){function t(e,r,n){i(this,t);var a=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return a.params=e,a.controls=r,a.urls=n,a.weather={fromAPI:{coord:{lon:"0",lat:"0"},weather:[{id:" ",main:" ",description:" ",icon:" "}],base:" ",main:{temp:0,pressure:" ",humidity:" ",temp_min:" ",temp_max:" "},wind:{speed:0,deg:" "},rain:{},clouds:{all:" "},dt:"",sys:{type:" ",id:" ",message:" ",country:" ",sunrise:" ",sunset:" "},id:" ",name:"Undefined",cod:" "}},a}return s(t,e),u(t,[{key:"httpGet",value:function(e){var t=this;return new Promise(function(r,n){var a=new XMLHttpRequest;a.onload=function(){if(200===a.status)r(JSON.parse(this.response));else{var e=Error(this.statusText);e.code=this.status,n(t.error)}},a.ontimeout=function(e){n(Error("Время ожидания обращения к серверу API истекло "+e.type+" "+e.timeStamp.toFixed(2)))},a.onerror=function(e){n(Error("Ошибка обращения к серверу "+e))},a.open("GET",e,!0),a.send(null)})}},{key:"getWeatherFromApi",value:function(){var e=this;this.httpGet(this.urls.urlWeatherAPI).then(function(t){e.weather.fromAPI=t,e.weather.naturalPhenomenon=f.naturalPhenomenon[e.params.lang].description,e.weather.windSpeed=w.windSpeed[e.params.lang],e.httpGet(e.urls.paramsUrlForeDaily).then(function(t){e.weather.forecastDaily=t,e.parseDataFromServer()},function(t){console.log("Возникла ошибка "+t),e.parseDataFromServer()})},function(t){console.log("Возникла ошибка "+t),e.parseDataFromServer()})}},{key:"getParentSelectorFromObject",value:function(e,t,r,n){for(var a in e)if("object"===l(e[a][r])&&null==n){if(t>=e[a][r][0]&&t<e[a][r][1])return a}else if(null!=n&&t>=e[a][r]&&t<e[a][n])return a}},{key:"parseDataFromServer",value:function(){var e=this.weather;if("Undefined"===e.fromAPI.name||"404"===e.fromAPI.cod)return void console.log("Данные от сервера не получены");var t={cloudiness:" ",dt:" ",cityName:" ",icon:" ",temperature:" ",temperatureMin:" ",temperatureMAx:" ",pressure:" ",humidity:" ",sunrise:" ",sunset:" ",coord:" ",wind:" ",weather:" "},r=parseInt(e.fromAPI.main.temp.toFixed(0),10)+0;if(t.cityName=e.fromAPI.name+", "+e.fromAPI.sys.country,t.temperature=r,t.temperatureMin=parseInt(e.fromAPI.main.temp_min.toFixed(0),10)+0,t.temperatureMax=parseInt(e.fromAPI.main.temp_max.toFixed(0),10)+0,e.naturalPhenomenon&&(t.weather=e.naturalPhenomenon[e.fromAPI.weather[0].id]),e.windSpeed){var n="fr"==myWidgetParam.lang?"Vent: ":"Wind: ";t.windSpeed=n+e.fromAPI.wind.speed.toFixed(1)+" m/s "+this.getParentSelectorFromObject(e.windSpeed,e.fromAPI.wind.speed.toFixed(1),"speed_interval"),t.windSpeed2=e.fromAPI.wind.speed.toFixed(1)+" m/s"}e.windDirection&&(t.windDirection=""+this.getParentSelectorFromObject(e.windDirection,e.fromAPI.wind.deg,"deg_interval")),e.clouds&&(t.clouds=""+this.getParentSelectorFromObject(e.clouds,e.fromAPI.clouds.all,"min","max")),t.humidity=e.fromAPI.main.humidity+"%",t.pressure=e.fromAPI.main.pressure+" mb",t.icon=""+e.fromAPI.weather[0].icon,this.renderWidget(t)}},{key:"renderWidget",value:function(e){for(var t in this.controls.cityName)this.controls.cityName.hasOwnProperty(t)&&(this.controls.cityName[t].innerHTML=e.cityName);for(var r in this.controls.temperature)this.controls.temperature.hasOwnProperty(r)&&(this.controls.temperature[r].innerHTML=e.temperature+"<span class='weather-left-card__degree'>"+this.params.textUnitTemp+"</span>");for(var n in this.controls.mainIconWeather)this.controls.mainIconWeather.hasOwnProperty(n)&&(this.controls.mainIconWeather[n].src=this.getURLMainIcon(e.icon,!0),this.controls.mainIconWeather[n].alt="Weather in "+(e.cityName?e.cityName:""));if(e.weather)for(var a in this.controls.naturalPhenomenon)this.controls.naturalPhenomenon.hasOwnProperty(a)&&(this.controls.naturalPhenomenon[a].innerText=e.weather);if(e.windSpeed)for(var i in this.controls.windSpeed)this.controls.windSpeed.hasOwnProperty(i)&&(this.controls.windSpeed[i].innerText=e.windSpeed);for(var o in this.controls.cityName2)this.controls.cityName2.hasOwnProperty(o)&&(this.controls.cityName2[o].innerHTML=e.cityName);for(var s in this.controls.temperature2)this.controls.temperature2.hasOwnProperty(s)&&(this.controls.temperature2[s].innerHTML=e.temperature+"<span>"+this.params.textUnitTemp+"</span>"),this.controls.temperatureFeels.hasOwnProperty(s)&&(this.controls.temperatureFeels[s].innerHTML=e.temperature+"<span>"+this.params.textUnitTemp+"</span>");for(var l in this.controls.temperatureMin)this.controls.temperatureMin.hasOwnProperty(l)&&(this.controls.temperatureMin[l].innerHTML=e.temperature+"<span>"+this.params.textUnitTemp+"</span>");for(var u in this.controls.temperatureMax)this.controls.temperatureMax.hasOwnProperty(u)&&(this.controls.temperatureMax[u].innerHTML=e.temperature+"<span>"+this.params.textUnitTemp+"</span>");if(e.weather)for(var d in this.controls.naturalPhenomenon2)this.controls.naturalPhenomenon2.hasOwnProperty(d)&&(this.controls.naturalPhenomenon2[d].innerText=e.weather);if(e.windSpeed2&&e.windDirection)for(var c in this.controls.windSpeed2)this.controls.windSpeed2.hasOwnProperty(c)&&(this.controls.windSpeed2[c].innerText=e.windSpeed2+" "+e.windDirection);for(var m in this.controls.mainIconWeather2)this.controls.mainIconWeather2.hasOwnProperty(m)&&(this.controls.mainIconWeather2[m].src=this.getURLMainIcon(e.icon,!0),this.controls.mainIconWeather2[m].alt="Weather in "+(e.cityName?e.cityName:""));if(e.humidity)for(var h in this.controls.humidity)this.controls.humidity.hasOwnProperty(h)&&(this.controls.humidity[h].innerText=e.humidity);if(e.pressure)for(var p in this.controls.pressure)this.controls.pressure.hasOwnProperty(p)&&(this.controls.pressure[p].innerText=e.pressure);for(var f in this.controls.dateReport)this.controls.dateReport.hasOwnProperty(f)&&(this.controls.dateReport[f].innerText=this.getTimeDateHHMMMonthDay());this.controls.graphic&&this.weather.forecastDaily&&this.prepareDataForGraphic()}},{key:"prepareDataForGraphic",value:function(){var e=[],t="fr"==myWidgetParam.lang?"Auj":"Today";for(var r in this.weather.forecastDaily.list){var n=this.getDayNameOfWeekByDayNumber(this.getNumberDayInWeekByUnixTime(this.weather.forecastDaily.list[r].dt));e.push({min:Math.round(this.weather.forecastDaily.list[r].temp.min),max:Math.round(this.weather.forecastDaily.list[r].temp.max),day:0!=r?n:t,icon:this.weather.forecastDaily.list[r].weather[0].icon,date:this.timestampToDateTime(this.weather.forecastDaily.list[r].dt)})}return this.drawGraphicD3(e)}},{key:"renderIconsDaysOfWeek",value:function(e){var t=this;return e.forEach(function(e,r){t.controls.calendarItem[r].innerHTML=e.day+'<img src="http://openweathermap.org/img/w/'+e.icon+'.png" width="32" height="32" alt="'+e.day+'">'}),e}},{key:"getURLMainIcon",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?!1:arguments[1],r=new Map;return t?this.params.baseURL+"/img/widgets/"+e+".png":(r.set("01d","01dbw"),r.set("02d","02dbw"),r.set("03d","03dbw"),r.set("03d","03dbw"),r.set("04d","04dbw"),r.set("05d","05dbw"),r.set("06d","06dbw"),r.set("07d","07dbw"),r.set("08d","08dbw"),r.set("09d","09dbw"),r.set("10d","10dbw"),r.set("11d","11dbw"),r.set("13d","13dbw"),r.set("01n","01dbw"),r.set("02n","02dbw"),r.set("03n","03dbw"),r.set("03n","03dbw"),r.set("04n","04dbw"),r.set("05n","05dbw"),r.set("06n","06dbw"),r.set("07n","07dbw"),r.set("08n","08dbw"),r.set("09n","09dbw"),r.set("10n","10dbw"),r.set("11n","11dbw"),r.set("13n","13dbw"),r.get(e)?this.params.baseURL+"/img/widgets/"+e+"img/"+r.get(e)+".png":"http://openweathermap.org/img/w/"+e+".png")}},{key:"drawGraphicD3",value:function(e){this.renderIconsDaysOfWeek(e);var t={id:"#graphic",data:e,offsetX:15,offsetY:10,width:420,height:79,rawData:[],margin:10,colorPolilyne:this.params.colorPolilyne,fontSize:"12px",fontColor:"#333",strokeWidth:"1px"},r=new h["default"](t);r.render()}},{key:"render",value:function(){this.getWeatherFromApi()}}]),t}(c["default"]));r["default"]=g},{"./custom-date":1,"./data/natural-phenomenon-data":2,"./data/wind-speed-data":3,"./graphic-d3js":5}]},{},[6]);